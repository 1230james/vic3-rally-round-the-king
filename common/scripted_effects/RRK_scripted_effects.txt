# Prime Minister handling effects
# Scope: Country
RRK_se_set_prime_minister = {
    random_interest_group = {
        limit = {
            is_in_government = yes
            is_strongest_ig_in_government = yes
        }
        owner = {
            set_variable = {
                name  = RRK_head_of_gov
                value = prev
            }
        }
    }
    if = { # Clear/reset variable if somehow nobody is in government
        limit = {
            has_variable = RRK_head_of_gov
            var:RRK_head_of_gov = {
                is_in_government = no
            }
        }
        remove_variable = RRK_head_of_gov
        set_variable = RRK_head_of_gov
    }
}

RRK_se_set_premier = {
    # ordered_interest_group = {
        # max = 1
        # order_by = ig_clout
    # }
    remove_variable = RRK_head_of_gov
    get_ruler_for:presidential_elective = {
        interest_group = {
            owner = {
                set_variable = {
                    name  = RRK_head_of_gov
                    value = prev
                }
            }
        }
    }
}

RRK_se_update_head_of_gov_modifier = {
    if = {
        limit = {
            RRK_st_is_presidential_monarchy = yes
            has_variable = RRK_head_of_gov
            var:RRK_head_of_gov ?= {
                is_in_government = yes
            }
            ruler.interest_group = { # the king is head of state, so pres. repub. already gives them +10 legitimacy
                is_in_government = no
            }
        }
        if = {
            limit = {
                NOT = {
                    has_modifier = RRK_md_head_of_gov_in_gov
                }
            }
            add_modifier = {
                name = RRK_md_head_of_gov_in_gov
            }
        }
    }
    else_if = {
        limit = {
            has_modifier = RRK_md_head_of_gov_in_gov
        }
        remove_modifier = RRK_md_head_of_gov_in_gov
    }
}

# Fate of monarchy event effects
# Scope: Country
RRK_se_fire_monarch_fate_event = {
    set_variable = {
        name  = RRK_preserve_monarchy
        value = yes
    }
    RRK_se_set_prime_minister = yes
    RRK_se_update_head_of_gov_modifier = yes
    if = {
        limit = {
            exists = heir
        }
        set_variable = {
            name  = RRK_monarch
            value = ruler
        }
        set_variable = {
            name  = RRK_heir
            value = heir
        }
        trigger_event = {
            id    = RRK_ev.2
            popup = yes
        }
    }
    else = {
        set_variable = {
            name  = RRK_monarch
            value = ruler
        }
        trigger_event = {
            id    = RRK_ev.3
            popup = yes
        }
    }
}

RRK_se_save_monarchy = {
    custom_tooltip = {
        text = RRK_tt_save_monarchy
        # Just in case I need it
    }
}

RRK_se_abolish_monarchy = {
    custom_tooltip = {
        text = RRK_tt_abolish_monarchy
        
        remove_variable = RRK_preserve_monarchy
        if = {
            limit = {
                has_variable = RRK_head_of_gov
            }
            remove_variable = RRK_head_of_gov
        }
        RRK_se_update_head_of_gov_modifier = yes
    }
    
    if = {
        limit = {
            country_has_voting_franchise = no
        }
        custom_tooltip = RRK_tt_stay_as_president
    }
    else_if = {
        limit = {
            var:RRK_monarch.interest_group.leader = var:RRK_monarch
        }
        custom_tooltip = RRK_tt_stay_as_ig_leader
    }
    
    
}

# Debug effects
RRK_se_debug_1 = {
    activate_law = law_type:law_universal_suffrage
    activate_law = law_type:law_parliamentary_republic
}
RRK_se_debug_2 = {
    activate_law = law_type:law_oligarchy
    activate_law = law_type:law_presidential_republic
}
RRK_se_debug_3 = {
    activate_law = law_type:law_autocracy
    activate_law = law_type:law_monarchy
}
